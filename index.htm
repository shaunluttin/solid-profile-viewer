<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Profile Viewer</title>
</head>
<body>
  <h1>Profile viewer</h1>
  <p id="login">
    You are not logged in.
    <button id="btnLogin">Log In</button>
  </p>
  <p id="logout">
    You are logged in as <span id="user"></span>.
    <p>
      <label for="profile">Profile:</label>
      <input id="profile">
    </p>
    <button id="btnLogout">Log Out</button>
  </p>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <script src="https://solid.github.io/solid-auth-client/dist/solid-auth-client.bundle.js"></script>
  <script>
    const popupUri = 'popup.html';
    $('#btnLogin').click(() => solid.auth.popupLogin({ popupUri }));
    $('#btnLogout').click(() => solid.auth.logout());

    solid.auth.trackSession(session => {
      const loggedIn = !!session;
      $('#login').toggle(!loggedIn);
      $('#logout').toggle(loggedIn);
      $('#user').text(session && session.webId);
    });

    solid.auth.trackSession(session => {
      // …
      if (session) {
        $('#user').text(session.webId);
        if (!$('#profile').val())
          $('#profile').val(session.webId);
      }
    });
  
  </script>
</body>
</html>
